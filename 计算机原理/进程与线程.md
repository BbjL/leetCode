


##### 进程与线程的简单理解
- 进程。进程是操作系统分配资源的基本单位，进程可以共享计算机的资源，执行一个进程时，CPU会为这个进程分配内存空间，进程之间的内存空间时相互独立。因此，进程间互不影响，一个进程崩溃并不会影响其他的进程。

- 线程。线程是CPU任务调度的最小单位，同一个进程的线程内存空间是共享的。如果一个线程奔溃将会影响到一个程序，导致程序崩溃。

##### 进程的并发
一个CPU同时只能运行一个进程，只有一个CPU并发任务的情况是一个CPU在频繁进行进程切换，由于切换速度快速，因此会给人一种并发的感觉，实际上是一种伪并发。多核处理器则很好的解决了进程并发的问题，真正实现进程的并发。

##### 进程和线程之间的区别
1. 线程是程序执行的最小单位，而进程是操作系统分配资源的最小单位；

2. 一个进程由一个或多个线程组成，线程是一个进程中代码的不同执行路线

3. 进程之间相互独立，但同一进程下的各个线程之间共享程序的内存空间(包括代码段，数据集，堆等)及一些进程级的资源(如打开文件和信

号等)，某进程内的线程在其他进程不可见。如线程奔溃将会导致整个进程的崩溃，一个进程崩溃并不会影响其他的进程。

4. 调度和切换：线程上下文切换比进程上下文切换要快得多

##### 进程间通信（IPC，InterProcess Communication）
1. 匿名管道
  - 半双工，只能传输一个方向的数据，双方通信需要建立两个通道
  - 用于父子进程和兄弟进程之间的通信（由于匿名的原因，只适用于亲有亲缘关系的进程间通信）
  - 在内存中单独构建出一个文件系统进行通信
  - 队列的形式进行读写操作

2. 有名管道
  - 存在于内存之中，通过内核缓冲实现数据传输。
  - 在磁盘上有对应的节点，任何进程都可以通过文件名将其打开和进行读写，而不局限于父子进程。
  - 以队列的形式进行读写操作
  例子：用命名管道实现聊天程序，一个张三端，一个李四端。两个程序都建立两个命名管道，fifo1,fifo2,张三写fifo1，李四读fifo1；李四写fifo2，张三读fifo2。 

5. 信号量(可用于进程和线程间的同步)
    1.临界资源：同一时刻，只能被一个进程访问的资源
    2.临界区：访问临界资源的代码区
    3.原子操作：任何情况下不能被打断的操作。
  -  它是一个计数器，记录资源能被多少个进程同时访问。用于控制多进程对临界资源的访问（同步），并且是非负值。主要作为进程间以及同一进程的不同线程间的同步手段。
  - “读—写，互斥、“写一写”互斥和“读—读”允许。

3. 消息队列
  - 存在于内核中的一个消息队列
  - 消息队列允许一个或多个进程向它写入与读取消息.
  - 消息队列与管道通信相比，其优势是对每个消息指定特定的消息类型，接收的时候不需要按照队列次序，而是可以根据自定义条件接收特定类型的消息。
  - 进程间通过消息队列通信，主要是：创建或打开消息队列，添加消息，读取消息和控制消息队列。
  
4. 共享内存
  - 进程不再通过执行进入内核的系统调用来传递彼此的数据
  - 共享内存允许两个或多个进程共享一个给定的存储区，这一段存储区可以被两个或两个以上的进程映射至自身的地址空间中，一个进程写入共享内存的信息，可以被其他使用这个共享内存的进程，通过一个简单的内存读取错做读出，从而实现了进程间的通信。
  - 进程可以直接读写内存，而不需要任何数据的拷贝，对于像管道和消息队里等通信方式，则需要再内核和用户空间进行四次的数据拷贝，而共享内存则只拷贝两次：一次从输入文件到共享内存区，另一次从共享内存到输出文件。
  - 由于多个进程共享一段内存，因此需要依靠某种同步机制（如**信号量**）来达到进程间的同步及互斥。
  信号量规定 在对共享资源进行读写时，其中一个进程在进行读操作时，不能进行写操作，进程进行写操作室不允许其他进程进行读操作，允许多个进程进程同时进行只读操作

7. 套接（socket）字
  - 适合同一主机的不同进程间和不同主机的进程间进行全双工网络通信。但并不只是Linux有，在所有提供了TCP/IP协议栈的操作系统中几乎都提供了socket，而所有这样操作系统，对套接字的编程方法几乎是完全一样的,即“网络编程”。

##### 进程线程冲突的解决办法（线程的协调机制）
当同一个进程同时执行多个线程时，需要注意各个线程的冲突。主要有两个办法防止线程间的冲突。
- **互斥锁**
  一个内存空间有限，当一个线程正在使用一个内存空间时，这个内存空间将处理使用中的状态，其他线程将不能使用使用这个内存空间处于等候状态，只有执行完这个线程的任务后才能继续使用这个内存空间
- **信号量**
  当一个内存空间可以同时容纳多个线程使用时，这个内存空间将会以信号量的形式标志这个内存空间可以供余下多少个线程使用。当信号量为0时，其他线程将处理等候状态。

##### 进程线程切换的开销
进程间切换时，需要保存当前的执行上下文后跳转到其他的进程的执行上下文，需要进行上下文之间的切换
线程共享进程的执行上下文，不需要CPU进行频繁的切换，因此开销会比进程小很多


[进程与线程的一个简单解释](http://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html)
[进程间通讯的7种方式](https://blog.csdn.net/zhaohong_bo/article/details/89552188)

